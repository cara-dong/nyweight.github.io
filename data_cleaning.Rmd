---
title: "Data Sources & Cleaning"
output: 
  html_document:
    toc: true
    toc_float: true
---
## Data Sourcess

* **[Student Weight Status](https://health.data.ny.gov/Health/Student-Weight-Status-Category-Reporting-Results-B/es3k-2aus)**: The source is official health.data.ny.gov (NY state government). The data provides information about weight status category data (underweight, healthy weight, overweight or obese) and estimates of the percent of students overweight, obese and overweight or obese for all reportable grades within the county and/or region and by grade groups (elementary and middle/high).

* **[IMDB](https://pad.human.cornell.edu/schools/datadownload.cfm)**: The source is Cornell University's data library. The data provides

```{r message=FALSE, echo=FALSE}
library(tidyverse)
library(readr)
```

## Data Cleaning
### Student Weight Data
```{r message=FALSE}
Student_Weight = read_csv("data/Student Weight.csv")
```

```{r}
Student_Weight  = 
  Student_Weight |>
  janitor::clean_names() |>
  rename('district'='location_code') |>
  filter(year_reported %in% c("2014-2015", "2015-2016", "2016-2017", "2017-2018", "2018-2019"))
```

```{r}
Student_Weight$year_reported = sub(".*-", "", Student_Weight$year_reported)

Student_Weight = 
  Student_Weight |>
  mutate(year_reported = as.numeric(Student_Weight$year_reported)) |>
  filter(grade_level!="DISTRICT TOTAL" & sex!="ALL")
```

```{r message=FALSE}
Student_Weight = Student_Weight |> filter(year_reported==2019 & county!='STATEWIDE (EXCLUDING NYC)') |> select(-region, -area_name)
```

```{r}
show_student_weight = 
  Student_Weight |>
  knitr::kable(digits = 3) |>
  kableExtra::kable_styling(bootstrap_options = c("striped", "hover"), font_size = 12) |> 
  kableExtra::scroll_box(width = "100%", height = "300px")
```

```{r}
show_student_weight
```

Description and what we did: xxxxx

### Demographics Data
```{r message=FALSE}
Demographics_all = read_csv("data/Demographics_all.csv")
```

```{r message=FALSE}
Demographics_all = 
  Demographics_all |> 
  janitor::clean_names() |>
  mutate(district = as.numeric(district)) |>
  filter(year==2019)

Demographics_all
```

Join Demographics with Student Weight
```{r message=FALSE}
result = merge(Student_Weight, Demographics_all, by = "district")|>
  select(-num_free_lunch, -num_reduced_lunch, -num_ell, -year_reported) |>
  drop_na()

head(result)
```

```{r}
length(unique(result$county))
```


Export to csv for use
```{r}
write.csv(result, file = "result_2019.csv", row.names = FALSE)
```